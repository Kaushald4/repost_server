syntax = "proto3";

package community.v1;

import "community/v1/enums.proto";
import "community/v1/media.proto";
import "community/v1/rules.proto";
import "community/v1/counts.proto";

message Cursor {
  string createdAt = 1;
  string id        = 2;
}

message CommunitySummary {
  string id    = 1;
  string name  = 2;
  string title = 3;

  Media icon   = 4;
  Media banner = 5;

  CommunityInfoCount counts = 6;

  string createdAt = 7;
  string updatedAt = 8;
}

message Community {
  string id          = 1;
  string name        = 2;
  string title       = 3;
  string description = 4;

  string ownerId = 5;

  CommunityVisibility visibility = 6;
  CommunityStatus     status     = 7;

  Media icon   = 8;
  Media banner = 9;

  repeated CommunityRule rules  = 10;
  CommunityInfoCount     counts = 11;

  string createdAt = 12;
  string updatedAt = 13;

  repeated Moderator moderators = 14;
}

message Moderator {
  string                   id          = 1;
  string                   userId      = 2;
  string                   communityId = 3;
  string                   invitedAt   = 4;
  string                   respondedAt = 5;
  CommunityModeratorRole   role        = 6;
  CommunityModeratorStatus status      = 7;
}

message CommunityPage {
  Community     community     = 1;
  ViewerContext viewerContext = 2;
}

message ViewerContext {
  bool             is_authenticated  = 1;
  Membership       membership        = 2;
  Role             role              = 3;
  CommunityContext community_context = 4;
}

message Membership {
  bool                  is_member     = 1;
  CommunityMemberStatus member_status = 2;
  bool                  is_banned     = 3;
  string                banned_until  = 4;
}

message Role {
  bool                   is_owner       = 1;
  bool                   is_moderator   = 2;
  CommunityModeratorRole moderator_role = 3;
}

message CommunityContext {
  CommunityVisibility visibility = 1;
}

message CommunityResponse {
  Community community = 1;
}

message DeleteCommunityResponse {
  bool success = 1;
}

message CommunityMembershipResponse {
  bool                           exists      = 1;
  optional string                communityId = 2;
  optional string                userId      = 3;
  optional string                id          = 4;
  optional CommunityMemberStatus status      = 5;
  optional string                joinedAt    = 6;
  optional string                leftAt      = 7;
  optional string                bannedAt    = 8;
}

message JoinCommunityResponse {
  bool success = 1;
}

message LeaveCommunityResponse {
  bool success = 1;
}